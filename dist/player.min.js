function Player(t){this.options=t,this.init()}Player.prototype={init:function(){var t=this,e=t.options.container;e.classList.add("ge-player"),e.innerHTML='<div class="image"></div><div class="buttons"><span data="list" class="fa fa-list"></span></div><div class="control"><div class="title"></div><span data="prev" class="fa fa-step-backward"></span><span data="play" class="fa fa-play"></span><span data="next" class="fa fa-step-forward"></span></div><div class=progress><div class="wrap"><div class="bar"></div><div class="cursor"></div><div class="time"></div></div></div><div class="playlist hide"></div>',t.image=e.querySelector(".image"),t.title=e.querySelector(".title"),t.btprev=e.querySelector("*[data=prev]"),t.btplay=e.querySelector("*[data=play]"),t.btnext=e.querySelector("*[data=next]"),t.btplaylist=e.querySelector("*[data=list]"),t.playlist=e.querySelector(".playlist"),t.prcur=e.querySelector(".cursor"),t.prtime=e.querySelector(".time"),t.audio=new Audio,t.setSongs([]),t.bindEvents()},bindEvents:function(){var t=this;t.btplaylist.addEventListener("click",function(e){this.classList.toggle("active"),t.playlist.classList.toggle("hide")},!1),t.btprev.addEventListener("click",function(e){t.play(t.previous())},!1),t.btnext.addEventListener("click",function(e){t.play(t.next())},!1),t.btplay.addEventListener("click",function(e){t.audio.paused?t.audio.play():t.audio.pause()},!1),t.audio.addEventListener("ended",function(e){t.play(t.next())},!1),t.audio.addEventListener("timeupdate",function(e){var a=this.currentTime,i=t.duration||this.duration;t.prcur.style.left=i?a/i*100+"%":0,t.prtime.innerHTML=t.timestr(a)+"/"+t.timestr(i)},!1);var e=function(e){var a=["add","remove"];"pause"==e.type&&a.reverse();var i=t.btplay.classList;i[a[1]]("fa-play"),i[a[0]]("fa-pause"),t.image.classList[a[0]]("ge-roll")};t.audio.addEventListener("play",e,!1),t.audio.addEventListener("pause",e,!1),t.playlist.addEventListener("click",function(e){var a=Array.prototype.indexOf.call(this.childNodes,e.target);a>=0&&t.play(a)},!1)},safeHTML:function(t){return t.replace(/[&"<]/g,function(t){return{"&":"&amp;",'"':"&quot;","<":"&lt;"}[t]})},setSongs:function(t){var e=this,a=[];e.songs=t,e.songs.forEach(function(t){var i=e.safeHTML(t.name);a.push('<div title="'+i+'">'+i+"</div>")}),e.playlist.innerHTML=a.join(""),e.current=-1,e.duration=0,e.play(0)},play:function(t){var e=this,a=null;if(t>=0&&t<e.songs.length){if(e.current==t)e.audio.currentTime=0;else{var i=e.playlist.childNodes,s=i[e.current];s&&s.classList.remove("active"),e.current=t,i[e.current].classList.add("active");var n=e.songs[e.current];e.title.innerHTML=e.safeHTML(n.name),e.audio.src=n.url,e.duration=n.duration?n.duration/1e3:null,a=n.image}e.prtime.innerHTML="",e.prcur.style.left=0,e.audio.play()}a||(a=e.options.image),a&&(e.image.innerHTML='<img src="'+e.safeHTML(a)+'">')},previous:function(){return(this.current-1)%this.songs.length},next:function(){return(this.current+1)%this.songs.length},timestr:function(t){if(isNaN(t))return"??:??";var e=Math.floor(t/60);return t=Math.floor(t)%60,10>t&&(t="0"+t),10>e&&(e="0"+e),e+":"+t}};