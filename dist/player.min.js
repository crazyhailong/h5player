function Player(t){this.options=t,this.init()}Player.prototype={_classes:{list:"fa fa-list",prev:"fa fa-step-backward",play:"fa fa-play",next:"fa fa-step-forward",pause:"fa fa-pause"},extend:function(t,e){for(var s in e)t[s]=e[s];return t},init:function(){var t=this,e=t.options.container;t.classes=t.extend({},t._classes),t.options.classes&&t.extend(t.classes,t.options.classes),e.classList.add("ge-player"),e.innerHTML='<div class="image"></div><div class="buttons"><i data="list" class="'+t.classes.list+'"></i></div><div class="control"><div class="title"></div><i data="prev" class="'+t.classes.prev+'"></i><i data="play" class="'+t.classes.play+'"></i><i data="next" class="'+t.classes.next+'"></i></div><div class=progress><div class="wrap"><div class="bar"></div><div class="cursor"></div><div class="time"></div></div></div><div class="playlist hide"></div>',t.image=e.querySelector(".image"),t.title=e.querySelector(".title"),t.btprev=e.querySelector("*[data=prev]"),t.btplay=e.querySelector("*[data=play]"),t.btnext=e.querySelector("*[data=next]"),t.btplaylist=e.querySelector("*[data=list]"),t.playlist=e.querySelector(".playlist"),t.prcur=e.querySelector(".cursor"),t.prtime=e.querySelector(".time"),t.audio=new Audio,t.setSongs([]),t.bindEvents()},bindEvents:function(){var t=this;t.btplaylist.addEventListener("click",function(e){this.classList.toggle("active"),t.playlist.classList.toggle("hide")},!1),t.btprev.addEventListener("click",function(e){t.play(t.previous())},!1),t.btnext.addEventListener("click",function(e){t.play(t.next())},!1),t.btplay.addEventListener("click",function(e){t.audio.paused?t.audio.play():t.audio.pause()},!1),t.audio.addEventListener("ended",function(e){t.play(t.next())},!1),t.audio.addEventListener("timeupdate",function(e){var s=this.currentTime,i=t.duration||this.duration;t.prcur.style.left=i?s/i*100+"%":0,t.prtime.innerHTML=t.timestr(s)+"/"+t.timestr(i)},!1);var e=function(e){var s=["play","pause"];"pause"==e.type&&s.reverse();var i=t.btplay.classList;t.classes[s[0]].split(/\s+/).forEach(function(t){i.remove(t)}),t.classes[s[1]].split(/\s+/).forEach(function(t){i.add(t)}),t.image.classList["play"==e.type?"add":"remove"]("ge-roll")};t.audio.addEventListener("play",e,!1),t.audio.addEventListener("pause",e,!1),t.playlist.addEventListener("click",function(e){var s=Array.prototype.indexOf.call(this.childNodes,e.target);s>=0&&t.play(s)},!1)},safeHTML:function(t){return t.replace(/[&"<]/g,function(t){return{"&":"&amp;",'"':"&quot;","<":"&lt;"}[t]})},setSongs:function(t){var e=this,s=[];e.songs=t,e.songs.forEach(function(t){var i=e.safeHTML(t.name);s.push('<div title="'+i+'">'+i+"</div>")}),e.playlist.innerHTML=s.join(""),e.current=-1,e.duration=0},play:function(t){var e=this;if(t>=0&&t<e.songs.length){if(e.current==t)e.audio.currentTime=0;else{var s=e.playlist.childNodes,i=s[e.current];i&&i.classList.remove("active"),e.current=t,s[e.current].classList.add("active");var a=e.songs[e.current];e.title.innerHTML=e.safeHTML(a.name),e.audio.src=a.url,e.duration=a.duration?a.duration/1e3:null;var r=a.image||e.options.image;r&&(e.image.innerHTML='<img src="'+e.safeHTML(r)+'">')}e.prtime.innerHTML="",e.prcur.style.left=0,e.audio.play()}},previous:function(){return(this.current-1)%this.songs.length},next:function(){return(this.current+1)%this.songs.length},timestr:function(t){if(isNaN(t))return"??:??";var e=Math.floor(t/60);return t=Math.floor(t)%60,10>t&&(t="0"+t),10>e&&(e="0"+e),e+":"+t}};