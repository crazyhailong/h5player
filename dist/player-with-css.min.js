!function(t,e){var i=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(i),i.styleSheet)i.styleSheet.disabled||(i.styleSheet.cssText=e);else try{i.innerHTML=e}catch(a){i.innerText=e}}(document,"@-webkit-keyframes ge-roll{from{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ge-roll{from{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.ge-player{background:#fff;box-shadow:0 0 10px gray;border-radius:3px;position:relative;max-width:400px}.ge-player .button{cursor:pointer}.ge-player .button.active,.ge-player .button:hover{color:#1e90ff}.ge-player .image{position:absolute;width:130px;height:130px;left:10px;top:10px;-webkit-animation:ge-roll 8s linear infinite;animation:ge-roll 8s linear infinite;-webkit-animation-play-state:paused;animation-play-state:paused}.ge-player .image img{width:100%;height:100%;border-radius:50%}.ge-player .ge-roll{-webkit-animation-play-state:running;animation-play-state:running}.ge-player .buttons{position:absolute;top:10px;right:10px}.ge-player .buttons>.button{margin-left:5px}.ge-player .control{padding:30px 10px 10px 150px;height:150px;text-align:center}.ge-player .control i{margin:10px;font-size:30px}.ge-player .title{font-weight:700}.ge-player .artist{font-size:.5em;height:20px}.ge-player .lyric{text-align:center;color:brown;font-size:.8em;height:2em}.ge-player .progress{padding:.5em 1em}.ge-player .progress .wrap{position:relative}.ge-player .progress .barwrap{padding:4px 0}.ge-player .progress .bar{height:2px;background:silver;position:relative}.ge-player .progress .played{position:absolute;top:0;height:2px;background:brown}.ge-player .progress .cursor{cursor:pointer;position:absolute;border:1px solid silver;background:#fff;border-radius:50%;width:10px;height:10px;top:0;margin-left:-5px}.ge-player .progress .time{font-size:.7em;position:absolute;right:0;top:-2em}.ge-player .playlist{max-height:200px;border-top:1px dashed gray;padding:.5em 1em;overflow-y:auto}.ge-player .playlist.hide{display:none}.ge-player .playlist>div{white-space:nowrap;text-overflow:ellipsis;color:#1a1a1a;cursor:pointer}.ge-player .playlist>div.active{color:#1e90ff;font-weight:700}.ge-player .playlist>div:hover{color:orange;font-weight:700}"),function(){"use strict";function t(){this.data=[]}function e(e){var i=this;i.parent=e,i.dataEvent=new t,"ontouchstart"in window?i.initTouch():"onmousedown"in window&&(i.mouse=!0)}function i(){this.data=[],this.last=0}function a(t){this.options=t,this.init()}"undefined"==typeof Array.prototype.find&&(Array.prototype.find=function(t){for(var e=this,i=0;i<e.length;i++){var a=e[i];if(t(a,i,e))return a}}),t.prototype={getCallbacks:function(t,e,i,a){var r=this.data.find(function(e,i,a){return e.element===t});if(!r){if(!a)return;r={element:t,events:[{},{}]},this.data.push(r)}var n=r.events[i?1:0],o=n[e];return!o&&a&&(n[e]=o=[]),o},add:function(t,e,i,a){var r=this.getCallbacks(t,e,a,!0);r.push(i)},remove:function(t,e,i,a){var r=this.getCallbacks(t,e,a);if(r){var n=r.indexOf(i);n>=0&&r.splice(n,1)}},forEachEvent:function(t){this.data.forEach(function(e){function i(i,a){for(var r in i){var n=i[r];n.forEach(function(i){t(e.element,r,i,a)})}}i(e.events[0],!1),i(e.events[1],!0)})}},e.prototype={threshold:5,initTouch:function(){var e=this,i=e.touchHandler.bind(e);e.touch=!0,e.dataTouch=new t,e.on(e.parent,"touchstart",i),e.on(e.parent,"touchmove",i),e.on(e.parent,"touchend",i),e.touches={}},on:function(t,e,i,a){this.dataEvent.add(t,e,i,a),t.addEventListener(e,i,a)},off:function(t,e,i,a){this.dataEvent.remove(t,e,i,a),t.removeEventListener(e,i,a)},delegate:function(t,e,i,a){var r=this;r.mouse&&r.on(t,e,i,a),r.touch&&r.dataTouch.add(t,e,i,a)},undelegate:function(t,e,i,a){var r=this;r.mouse&&r.off(t,e,i,a),r.touch&&r.dataTouch.remove(t,e,i,a)},ignore:function(){},forEach:function(t,e){Array.prototype.forEach.call(t,e)},fire:function(t,e){for(var i=this,a=function(a){var r=i.dataTouch.getCallbacks(a,t);r&&i.forEach(r,function(r){var o,s={type:t};for(o in e)s[o]=e[o];s.preventDefault=i.ignore,s.stopPropagation=n,r.call(a,s)})},r=!1,n=function(){r=!0},o=e.target;o&&(a(o),!r&&o!==i.parent);)o=o.parentNode},touchHandler:function(t){var e=this;t.preventDefault(),"touchstart"==t.type?e.forEach(t.changedTouches,function(t){e.touches[t.identifier]={evt:t},e.fire("mousedown",t)}):"touchmove"==t.type?e.forEach(t.changedTouches,function(t){var i=e.touches[t.identifier],a=i.evt;i.moved=i.moved||Math.abs(t.clientX-a.clientX)>e.threshold||Math.abs(t.clientY-a.clientY)>e.threshold,i.moved&&(i.evt=t,e.fire("mousemove",t))}):"touchend"==t.type&&e.forEach(t.changedTouches,function(t){e.fire("mouseup",t);var i=e.touches[t.identifier];delete e.touches[t.identifier],i&&!i.moved&&e.fire("click",t)})},getPoint:function(t){if("offsetX"in t)return{x:t.offsetX,y:t.offsetY};var e=t.target.getBoundingClientRect(),i=document.documentElement,a=window;return{x:t.pageX-(e.left+a.pageXOffset-i.clientLeft),y:t.pageY-(e.top+a.pageYOffset-i.clientTop)}},destroy:function(){var t=this;t.dataEvent.forEachEvent(function(t,e,i,a){t.removeEventListener(e,i,a)}),t.dataTouch=null,t.dataEvent=null}},i.prototype={setLyric:function(t){var e=this.data=[];if(this.last=0,t){var i=/^\[([^\]]*)\]\s*(.*)$/;t.split(/\n/).forEach(function(t){var a=t.match(i);if(a){var r=0;a[1].split(/:/).forEach(function(t){r=60*r+Number(t)}),e.push([r,a[2]])}})}},getLyricAtTime:function(t){var e,i=this,a=i.data,r=i.last,n=a[r]||a[r=0];if(n)if(n[0]<t){for(;(e=a[++r])&&e[0]<=t;)n=e;i.last=r-1}else{for(;n&&n[0]>t;)n=a[--r];i.last=r}return n?n[1]:""}},a.prototype={_classes:{list:"fa fa-list",prev:"fa fa-step-backward",play:"fa fa-play",next:"fa fa-step-forward",pause:"fa fa-pause"},extend:function(t,e){for(var i in e)t[i]=e[i];return t},init:function(){var t=this,e=t.options.container;t.classes=t.extend({},t._classes),t.options.classes&&t.extend(t.classes,t.options.classes),e.classList.add("ge-player"),e.innerHTML='<div class="image"></div><div class="buttons"><i data="list" class="button '+t.classes.list+'"></i></div><div class="control"><div class="title"></div><div class="artist"></div><i data="prev" class="button '+t.classes.prev+'"></i><i data="play" class="button '+t.classes.play+'"></i><i data="next" class="button '+t.classes.next+'"></i></div><div class="progress"><div class="wrap"><div class="barwrap"><div class="bar"><div class="played"></div></div></div><div class="cursor"></div><div class="time"></div></div></div><div class="lyric"></div><div class="playlist hide"></div>';var a=e.querySelector.bind(e);t.image=a(".image"),t.title=a(".title"),t.artist=a(".artist"),t.playlist=a(".playlist"),t.prwrap=a(".barwrap"),t.prcur=a(".cursor"),t.prtime=a(".time"),t.brplayed=a(".played"),t.lyric=a(".lyric"),Array.prototype.forEach.call(e.querySelectorAll(".button[data]"),function(e){t["bt"+e.getAttribute("data")]=e}),t.audio=new Audio,t.options.image&&(t.image.innerHTML='<img src="'+t.safeHTML(t.options.image)+'">'),t.setSongs([]),t.lyricParser=new i,t.bindEvents()},bindEvents:function(){var t=this,i=null,a=t.evtHandler=new e(t.options.container);a.delegate(t.btlist,"click",t.toggleList.bind(t)),a.delegate(t.btprev,"click",t.playPrev.bind(t)),a.delegate(t.btnext,"click",t.playNext.bind(t)),a.delegate(t.btplay,"click",t.togglePlay.bind(t)),a.on(t.audio,"ended",t.playAnother.bind(t)),a.on(t.audio,"timeupdate",function(e){var a=this.currentTime,r=t.duration;if(r||(r=t.duration=this.duration),!i){var n=r?a/r*100+"%":0;t.prcur.style.left=n,t.brplayed.style.width=n}t.prtime.innerHTML=t.timestr(a)+" / "+t.timestr(r),t.lyric.innerHTML=t.safeHTML(t.lyricParser.getLyricAtTime(a))});var r=function(e){var i=["play","pause"];"pause"==e.type&&i.reverse();var a=t.btplay.classList;t.classes[i[0]].split(/\s+/).forEach(function(t){a.remove(t)}),t.classes[i[1]].split(/\s+/).forEach(function(t){a.add(t)}),t.image.classList["play"==e.type?"add":"remove"]("ge-roll")};a.on(t.audio,"play",r),a.on(t.audio,"pause",r),a.delegate(t.playlist,"click",function(e){var i=Array.prototype.indexOf.call(this.childNodes,e.target);i>=0&&t.play(i)});var n=function(e,i){var a=e/t.prwrap.offsetWidth;0>a?a=0:a>1&&(a=1),t.prcur.style.left=t.brplayed.style.width=100*a+"%",i&&(t.audio.currentTime=~~(a*t.duration))};a.delegate(t.prwrap,"click",function(t){t.preventDefault();var e=a.getPoint(t).x;n(e,!0)});var o=function(t){i&&(i.moved=!0,n(t.clientX-i.delta))},s=function(t){i&&(t.preventDefault(),i=null)},l=function(t){i&&(n(t.clientX-i.delta,!0),s(t))},c=function(e){e.preventDefault(),i={delta:e.clientX-t.brplayed.offsetWidth}};a.delegate(t.prcur,"mousedown",c),a.delegate(t.options.container,"mousemove",o),a.delegate(t.options.container,"mouseup",l),a.on(t.options.container,"mouseleave",s)},safeHTML:function(t){return t.replace(/[&"<]/g,function(t){return{"&":"&amp;",'"':"&quot;","<":"&lt;"}[t]})},toggleList:function(){var t=this;t.btlist.classList.toggle("active"),t.playlist.classList.toggle("hide")},togglePlay:function(){var t=this;t.current<0?t.play(0):t.audio.paused?t.audio.play():t.audio.pause()},playPrev:function(){this.play(this.previous())},playNext:function(){this.play(this.next())},playAnother:function(){this.playNext()},setSongs:function(t){var e=this,i=[];e.songs=t,e.songs.forEach(function(t){var a=e.safeHTML(t.name);i.push('<div title="'+a+'">'+a+"</div>")}),e.playlist.innerHTML=i.join(""),e.current=-1,e.duration=0},getLyric:function(t){var e=this,i=e.songs[e.current];if("lyric"in i)e.lyricParser.setLyric(i.lyric);else if(e.lyricParser.setLyric(),"lyricjsonp"in i){var a,r="setLyric"+Date.now().toString(16)+(~~(65535*Math.random())).toString(16);window[r]=function(t){200!=t.code?i.lyric=null:(i.lyric=t.lyric,i===e.songs[e.current]&&e.lyricParser.setLyric(i.lyric)),delete window[r],a&&(clearTimeout(a),a=null)};var n=document.createElement("script");n.src=i.lyricjsonp+(/\?/.test(i.lyricjsonp)?"&":"?")+"jsonp="+r,n.onload=function(){document.body.removeChild(n)},document.body.appendChild(n),t&&(a=setTimeout(function(){delete window[r],a=null},t))}},play:function(t){var e=this;if(t>=0&&t<e.songs.length){if(e.current==t)e.audio.currentTime=0;else{var i=e.playlist.childNodes,a=i[e.current];a&&a.classList.remove("active"),e.current=t,i[e.current].classList.add("active");var r=e.songs[e.current];e.title.innerHTML=e.safeHTML(r.name),e.artist.innerHTML=e.safeHTML(r.artist||""),e.audio.src=r.url,e.duration=r.duration?r.duration/1e3:null;var n=r.image||e.options.image;n&&(e.image.innerHTML='<img src="'+e.safeHTML(n)+'">'),e.lyric.innerHTML="",e.getLyric(1e4)}e.prtime.innerHTML="",e.prcur.style.left=0,e.brplayed.style.width=0,e.audio.play()}},previous:function(){return(this.current+this.songs.length-1)%this.songs.length},next:function(){return(this.current+1)%this.songs.length},timestr:function(t){if(isNaN(t))return"??:??";var e=Math.floor(t/60);return t=Math.floor(t)%60,10>t&&(t="0"+t),10>e&&(e="0"+e),e+":"+t},destroy:function(){var t=this;t.evtHandler.destroy(),t.evtHandler=null,t.lyricParser=null,t.audio.src="",t.audio=null,t.options.container.innerHTML=""}},window.Player=a}.call({});